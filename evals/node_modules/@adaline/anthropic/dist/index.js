'use strict';

var zod = require('zod');

var Ho=Object.defineProperty,Ko=Object.defineProperties;var Go=Object.getOwnPropertyDescriptors;var Ot=Object.getOwnPropertySymbols;var Jo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable;var Zo=(n,e)=>(e=Symbol[n])?e:Symbol.for("Symbol."+n);var xt=(n,e,o)=>e in n?Ho(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,v=(n,e)=>{for(var o in e||(e={}))Jo.call(e,o)&&xt(n,o,e[o]);if(Ot)for(var o of Ot(e))Wo.call(e,o)&&xt(n,o,e[o]);return n},Se=(n,e)=>Ko(n,Go(e));var U=(n,e,o)=>new Promise((a,l)=>{var p=d=>{try{i(o.next(d));}catch(h){l(h);}},s=d=>{try{i(o.throw(d));}catch(h){l(h);}},i=d=>d.done?a(d.value):Promise.resolve(d.value).then(p,s);i((o=o.apply(n,e)).next());}),Yo=function(n,e){this[0]=n,this[1]=e;},At=(n,e,o)=>{var a=(s,i,d,h)=>{try{var g=o[s](i),w=(i=g.value)instanceof Yo,q=g.done;Promise.resolve(w?i[0]:i).then(I=>w?a(s==="return"?s:"next",i[1]?{done:I.done,value:I.value}:I,d,h):d({value:I,done:q})).catch(I=>a("throw",I,d,h));}catch(I){h(I);}},l=s=>p[s]=i=>new Promise((d,h)=>a(s,i,d,h)),p={};return o=o.apply(n,e),p[Zo("asyncIterator")]=()=>p,l("next"),l("throw"),l("return"),p};var Qo=n=>{let e=new WeakSet;return JSON.stringify(n,(o,a)=>{if(typeof a=="object"&&a!==null){if(e.has(a))return;e.add(a);}return a})},Xo=n=>n==null?"unknown error":typeof n=="string"?n:n instanceof Error?n.message:Qo(n),Re="GatewayBaseError",F=class qt extends Error{constructor({info:e,cause:o},a){super(`[${a!=null?a:Re}]: ${e}
Message: ${Xo(o)}`),this.name=Re,this.info=e,this.cause=o,this.name=a!=null?a:Re,Object.setPrototypeOf(this,new.target.prototype);}static isGatewayBaseError(e){return e instanceof qt}toJSON(){return {name:this.name,info:this.info,cause:this.cause,message:this.message,stack:this.stack}}},Z="system",z="user",k="assistant",Q="tool",en=[Z,z,k,Q],ve=zod.z.enum(en),tn=[k],on=zod.z.enum(tn),H="image",Oe="base64",nn=["png","jpeg","webp","gif"],an=zod.z.object({type:zod.z.literal(Oe),base64:zod.z.string(),media_type:zod.z.enum(nn)}),sn="url",rn=zod.z.object({type:zod.z.literal(sn),url:zod.z.string()}),ln=zod.z.discriminatedUnion("type",[an,rn]),dn=["low","medium","high","auto"],pn=zod.z.enum(dn),mn=(n=zod.z.undefined())=>zod.z.object({modality:zod.z.literal(H),detail:pn,value:ln,metadata:n}),O="text",It=(n=zod.z.undefined())=>zod.z.object({modality:zod.z.literal(O),value:zod.z.string(),metadata:n}),xe="partial-text",Lt=(n=zod.z.undefined())=>zod.z.object({modality:zod.z.literal(xe),value:zod.z.string(),metadata:n}),N="tool-call",jt=(n=zod.z.undefined())=>zod.z.object({modality:zod.z.literal(N),index:zod.z.number().int().nonnegative(),id:zod.z.string().min(1),name:zod.z.string().min(1),arguments:zod.z.string(),metadata:n}),Ae="partial-tool-call",Pt=(n=zod.z.undefined())=>zod.z.object({modality:zod.z.literal(Ae),index:zod.z.number().int().nonnegative(),id:zod.z.string().optional(),name:zod.z.string().optional(),arguments:zod.z.string().optional(),metadata:n}),K="tool-response",cn=(n=zod.z.undefined())=>zod.z.object({modality:zod.z.literal(K),index:zod.z.number().int().nonnegative(),id:zod.z.string().min(1),name:zod.z.string().min(1),data:zod.z.string(),metadata:n}),un=[O,H,N,K],Bt=zod.z.enum(un),hn=(n=zod.z.undefined(),e=zod.z.undefined(),o=zod.z.undefined(),a=zod.z.undefined())=>zod.z.discriminatedUnion("modality",[It(n),mn(e),jt(o),cn(a)]),gn=[xe,Ae];zod.z.enum(gn);var yn=(n=zod.z.undefined(),e=zod.z.undefined())=>zod.z.discriminatedUnion("modality",[Lt(n),Pt(e)]);var ke=(n=ve,e=zod.z.undefined(),o=zod.z.undefined(),a=zod.z.undefined(),l=zod.z.undefined(),p=zod.z.undefined())=>zod.z.object({role:n,content:zod.z.array(hn(e,o,a,l)),metadata:p}),_e=(n=on,e=zod.z.undefined(),o=zod.z.undefined(),a=zod.z.undefined())=>zod.z.object({role:n,partialContent:yn(e,o),metadata:a}),Nt=n=>It().parse({modality:O,value:n}),Vt=(n,e,o,a)=>jt().parse({modality:N,index:n,id:e,name:o,arguments:a});var we=(n,e)=>_e().parse({role:n,partialContent:Lt().parse({modality:xe,value:e})}),qe=(n,e,o,a,l)=>_e().parse({role:n,partialContent:Pt().parse({modality:Ae,index:e,id:o,name:a,arguments:l})});var ae=(n=zod.z.record(zod.z.string(),zod.z.any()).optional())=>n,fn=["object","array","number","string","boolean","enum"],kt=zod.z.enum(fn),bn=zod.z.object({anyOf:zod.z.array(zod.z.any()).optional(),type:zod.z.union([kt,zod.z.array(zod.z.union([kt,zod.z.literal("null")]))]).optional(),default:zod.z.any().optional(),title:zod.z.string().optional(),description:zod.z.string().max(4096).optional(),properties:zod.z.record(zod.z.any()).optional(),required:zod.z.array(zod.z.string()).optional(),minItems:zod.z.number().int().min(0).optional(),maxItems:zod.z.number().int().optional(),items:zod.z.record(zod.z.any()).optional(),enum:zod.z.array(zod.z.union([zod.z.string(),zod.z.number(),zod.z.boolean(),zod.z.null()])).optional(),minimum:zod.z.number().optional(),maximum:zod.z.number().optional(),minLength:zod.z.number().int().min(0).optional(),maxLength:zod.z.number().int().optional(),$ref:zod.z.string().optional()}),Cn=zod.z.object({type:zod.z.enum(["object"]),required:zod.z.array(zod.z.string()),$defs:zod.z.record(zod.z.any()).optional(),properties:zod.z.record(bn),additionalProperties:zod.z.literal(!1)});zod.z.object({name:zod.z.string().regex(/^[a-zA-Z0-9_]{1,64}$/).max(64),description:zod.z.string().max(4096),strict:zod.z.boolean().optional(),schema:Cn}).optional();var Tn="function";var Mn=zod.z.enum(["object","array","number","string","boolean","null"]),En=zod.z.object({anyOf:zod.z.array(zod.z.any()).optional(),type:Mn.optional(),default:zod.z.any().optional(),title:zod.z.string().optional(),description:zod.z.string().max(4096).optional(),properties:zod.z.record(zod.z.any()).optional(),required:zod.z.array(zod.z.string()).optional(),minItems:zod.z.number().int().min(0).optional(),maxItems:zod.z.number().int().optional(),items:zod.z.record(zod.z.any()).optional(),enum:zod.z.array(zod.z.union([zod.z.string(),zod.z.number(),zod.z.boolean(),zod.z.null()])).optional(),minimum:zod.z.number().optional(),maximum:zod.z.number().optional(),minLength:zod.z.number().int().min(0).optional(),maxLength:zod.z.number().int().optional()});zod.z.object({type:zod.z.enum(["object"]),title:zod.z.string().optional(),$defs:zod.z.record(zod.z.any()).optional(),properties:zod.z.record(En).optional(),required:zod.z.array(zod.z.string()).optional()});var Sn=zod.z.object({name:zod.z.string().regex(/^[a-zA-Z0-9_]{1,64}$/).max(64),description:zod.z.string().max(4096),parameters:zod.z.any(),strict:zod.z.boolean().optional()});var Rn=zod.z.enum(["function"]),vn=zod.z.object({type:Rn,definition:zod.z.object({schema:Sn})}),On=[Tn];zod.z.enum(On);var Ut=(n=zod.z.undefined())=>zod.z.discriminatedUnion("type",[vn.extend({metadata:n})]),G="text",zt="token",xn=[G,zt],$t=zod.z.enum(xn),An=zod.z.array(zod.z.string().min(1)),kn=zod.z.array(zod.z.array(zod.z.number().int().nonnegative())),Dt=(n=zod.z.undefined())=>zod.z.discriminatedUnion("modality",[zod.z.object({modality:zod.z.literal(G),metadata:n,requests:An}),zod.z.object({modality:zod.z.literal(zt),metadata:n,requests:kn})]),Ie="float",_n=zod.z.object({index:zod.z.number().int().nonnegative(),embedding:zod.z.array(zod.z.number())}),Le="base64",wn=zod.z.object({index:zod.z.number().int().nonnegative(),embedding:zod.z.string().base64()}),_t=zod.z.object({totalTokens:zod.z.number().int().nonnegative()});zod.z.discriminatedUnion("encodingFormat",[zod.z.object({encodingFormat:zod.z.literal(Ie),embeddings:zod.z.array(_n),usage:_t.optional()}),zod.z.object({encodingFormat:zod.z.literal(Le),embeddings:zod.z.array(wn),usage:_t.optional()})]);var Ft=zod.z.object({promptTokens:zod.z.number().nonnegative(),completionTokens:zod.z.number().nonnegative(),totalTokens:zod.z.number().nonnegative()}),wt=zod.z.object({token:zod.z.string(),logProb:zod.z.number(),bytes:zod.z.array(zod.z.number().int()).nullable()}),qn=wt.extend({topLogProbs:zod.z.array(wt)}),Ht=zod.z.array(qn);zod.z.object({messages:zod.z.array(ke()),usage:Ft.optional(),logProbs:Ht.optional()});zod.z.object({partialMessages:zod.z.array(_e()),usage:Ft.optional(),logProbs:Ht.optional()});var In=Object.defineProperty,Kt=Object.getOwnPropertySymbols,Ln=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable,Gt=(n,e,o)=>e in n?In(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,se=(n,e)=>{for(var o in e||(e={}))Ln.call(e,o)&&Gt(n,o,e[o]);if(Kt)for(var o of Kt(e))jn.call(e,o)&&Gt(n,o,e[o]);return n},Jt="ProviderError",je=class to extends F{constructor({info:e,cause:o}){super({info:e,cause:o},Jt),this.name=Jt,this.info=e,this.cause=o;}static isProviderError(e){return e instanceof to}};var Wt="ModelResponseError",$=class oo extends F{constructor({info:e,cause:o}){super({info:e,cause:o},Wt),this.name=Wt,this.cause=o,this.info=e;}static isModelResponseError(e){return e instanceof oo}},Zt="InvalidModelRequestError",X=class no extends F{constructor({info:e,cause:o}){super({info:e,cause:o},Zt),this.name=Zt,this.cause=o,this.info=e,Object.setPrototypeOf(this,new.target.prototype);}static isInvalidModelRequestError(e){return e instanceof no}},Yt="InvalidConfigError",D=class ao extends F{constructor({info:e,cause:o}){super({info:e,cause:o},Yt),this.name=Yt,this.cause=o,this.info=e,Object.setPrototypeOf(this,new.target.prototype);}static isInvalidConfigError(e){return e instanceof ao}},Qt="InvalidMessagesError",x=class so extends F{constructor({info:e,cause:o}){super({info:e,cause:o},Qt),this.name=Qt,this.cause=o,this.info=e,Object.setPrototypeOf(this,new.target.prototype);}static isInvalidMessagesError(e){return e instanceof so}},Xt="InvalidToolsError",Pe=class io extends F{constructor({info:e,cause:o}){super({info:e,cause:o},Xt),this.name=Xt,this.cause=o,this.info=e,Object.setPrototypeOf(this,new.target.prototype);}static isInvalidToolsError(e){return e instanceof io}},eo="InvalidEmbeddingRequestsError",Be=class ro extends F{constructor({info:e,cause:o}){super({info:e,cause:o},eo),this.name=eo,this.info=e,this.cause=o,Object.setPrototypeOf(this,new.target.prototype);}static isInvalidEmbeddingRequestsError(e){return e instanceof ro}},Ne="multi-string",lo=zod.z.object({type:zod.z.literal(Ne),param:zod.z.string().min(1),title:zod.z.string().min(1),description:zod.z.string().min(1).max(500),max:zod.z.number().int().positive()}),Pn=n=>zod.z.array(zod.z.string()).max(n).default([]).optional(),po=n=>({def:lo.parse(se({type:Ne},n)),schema:Pn(n.max)}),mo="object-schema",Bn=zod.z.object({type:zod.z.literal(mo),param:zod.z.string().min(1),title:zod.z.string().min(1),description:zod.z.string().min(1).max(500),objectSchema:zod.z.any()});var Ve="range",co=zod.z.object({type:zod.z.literal(Ve),param:zod.z.string().min(1),title:zod.z.string().min(1),description:zod.z.string().min(1).max(500),min:zod.z.number().int(),max:zod.z.number().int(),step:zod.z.number().positive(),default:zod.z.number()}),Nn=(n,e,o,a)=>zod.z.number().min(n).max(e).step(o).default(a).optional(),ee=n=>({def:co.parse(se({type:Ve},n)),schema:Nn(n.min,n.max,n.step,n.default)}),Ue="select-boolean",uo=zod.z.object({type:zod.z.literal(Ue),param:zod.z.string().min(1),title:zod.z.string().min(1),description:zod.z.string().min(1).max(500),default:zod.z.boolean().nullable()}),Vn=n=>zod.z.boolean().nullable().default(n).optional(),ho=n=>({def:uo.parse(se({type:Ue},n)),schema:Vn(n.default)}),ze="select-string",go=zod.z.object({type:zod.z.literal(ze),param:zod.z.string().min(1),title:zod.z.string().min(1),description:zod.z.string().min(1).max(500),default:zod.z.string().min(1).nullable(),choices:zod.z.array(zod.z.string().min(1))}),Un=(n,e)=>zod.z.enum(e).nullable().default(n).optional(),te=n=>({def:go.parse(se({type:ze},n)),schema:Un(n.default,n.choices)}),zn=[Ve,Ne,ze,mo,Ue];zod.z.enum(zn);var yo=zod.z.discriminatedUnion("type",[co,lo,go,uo,Bn]),T=(n=ve,e=Bt)=>zod.z.object({name:zod.z.string().min(1),description:zod.z.string().min(1),roles:zod.z.record(n,zod.z.string().min(1).optional()),modalities:zod.z.array(e).nonempty(),maxInputTokens:zod.z.number().int().positive().min(1),maxOutputTokens:zod.z.number().int().positive().min(1),config:zod.z.object({def:zod.z.record(zod.z.string().min(1),yo),schema:zod.z.instanceof(zod.z.ZodObject)}).refine(o=>{var a,l;let p=Object.keys(o.def),s=Object.keys((l=(a=o.schema)==null?void 0:a.shape)!=null?l:{});return p.every(i=>s.includes(i))&&s.every(i=>p.includes(i))},{message:"Keys in 'config.def' must exactly match keys in 'config.schema'"})}),L=(n=$t)=>zod.z.object({name:zod.z.string().min(1),description:zod.z.string().min(1),modalities:zod.z.array(n).nonempty(),maxInputTokens:zod.z.number().int().positive().min(1),maxOutputTokens:zod.z.number().int().positive().min(1),config:zod.z.object({def:zod.z.record(zod.z.string().min(1),yo),schema:zod.z.instanceof(zod.z.ZodObject)}).refine(e=>{var o,a;let l=Object.keys(e.def),p=Object.keys((a=(o=e.schema)==null?void 0:o.shape)!=null?a:{});return l.every(s=>p.includes(s))&&p.every(s=>l.includes(s))},{message:"Keys in 'config.def' must exactly match keys in 'config.schema'"})});zod.z.record(zod.z.string());zod.z.record(zod.z.union([zod.z.boolean(),zod.z.string(),zod.z.number(),zod.z.object({}),zod.z.array(zod.z.any()),zod.z.null(),zod.z.undefined()]));zod.z.string().url();var $n={type:"range",title:"Temperature",description:"Adjusts the model's creativity level. With a setting of 0, the model strictly picks the most probable next word.     For endeavors that benefit from a dash of inventiveness, consider dialing it up to 0.7 or higher, enabling the model to produce text     that's unexpectedly fresh."},Dn={type:"range",title:"Max tokens",description:"Specify the total tokens for generation, where one token approximates four English characters.     Setting this to 0 defaults to the model's maximum capacity."},Fn=n=>({type:"multi",title:"Stop sequence",description:`Enter up to ${n} sequences that will halt additional text output.       The generated text will exclude these sequences.`}),Hn={type:"range",title:"Top A",description:"Considers only the top tokens that have 'sufficiently high' probabilities relative to the most likely token,     functioning like a dynamic Top-P.     A lower Top-A value narrows down the token choices based on the highest probability token,     while a higher Top-A value refines the filtering without necessarily impacting the creativity of the output."},Kn={type:"range",title:"Top P",description:"Selects a subset of likely tokens for generation, restricting choices to the top-P fraction of possibilities,     such as the top 10% when P=0.1.     This approach can limit the variety of the output. By default, it's set to 1, indicating no restriction.     It's advised to adjust this parameter or temperature to modulate output diversity, but not to modify both simultaneously."},Gn={type:"range",title:"Top K",description:"Select only from the highest K probabilities for each following word, effectively eliminating the less likely 'long tail' options."},Jn={type:"range",title:"Min P",description:"Specifies the minimum probability a token must have to be considered, in relation to the probability of the most likely token.     (This value varies based on the confidence level of the top token.)     For example, if Min-P is set to 0.1, only tokens with at least 1/10th the probability of the highest-ranked token will be considered."},Wn={type:"range",title:"Frequency penalty",description:"Minimize redundancy.    By assigning a penalty to frequently used tokens within the text, the likelihood of repeating identical phrases is reduced.     The default setting for this penalty is zero."},Zn={type:"range",title:"Presence penalty",description:"Enhance the introduction of novel subjects by reducing the preference for tokens that have already appeared in the text,     thus boosting the chances of exploring fresh topics.     The standard setting for this is zero."},Yn={type:"range",title:"Seed",description:"When seed is fixed to a specific value, the model makes a best effort to provide the same response for repeated requests.     Deterministic output isn't guaranteed.     Also, changing the model or parameter settings, such as the temperature,     can cause variations in the response even when you use the same seed value.     By default, a random seed value is used."},Qn={type:"range",title:"Repetition penalty",description:"Reduces the likelihood of repeating tokens from the input.     Increasing this value makes the model less prone to repetition, but setting it too high may lead to less coherent output,     often resulting in run-on sentences missing smaller words.     The token penalty is scaled according to the original token's probability."},Xn={type:"boolean",title:"Log probs",description:"Whether to return log probabilities of the output tokens or not. If true, returns the log probabilities of each output token returned."},ea={type:"range",title:"Top log probs",description:"The number of most likely tokens to return at each token position, each with an associated log probability.     'logprobs' must be set to true if this parameter is used."},ta={type:"boolean",title:"Echo",description:"If true, the response will contain the prompt."},oa={type:"select",title:"Response format",description:"Choose the response format of your model. For JSON, you must include the string 'JSON' in some form within your system / user prompt."},na={type:"select",title:"Response format",description:"Choose the response format of your model. 'json_object' colloquially known as JSON mode, instructs the model to respond with a valid   JSON (must include the term 'json' in prompt). 'json_schema' colloquially known as structured outputs, allows you to specify a strict   response schema that the model will adhere to."},aa={type:"object",title:"Response schema",description:"When response format is set to 'json_schema', the model will return a JSON object of the specified schema."},V={TEMPERATURE:$n,MAX_TOKENS:Dn,STOP:Fn,TOP_A:Hn,TOP_P:Kn,TOP_K:Gn,MIN_P:Jn,FREQUENCY_PENALTY:Wn,PRESENCE_PENALTY:Zn,REPETITION_PENALTY:Qn,SEED:Yn,LOG_PROBS:Xn,TOP_LOG_PROBS:ea,ECHO:ta,RESPONSE_FORMAT:oa,RESPONSE_FORMAT_WITH_SCHEMA:na,RESPONSE_SCHEMA:aa};var ie=n=>Object.fromEntries(Object.entries(n).filter(([e,o])=>o!=null));var Y=n=>n==null?void 0:n.replace(/\/$/,"");var $e=ee({param:"temperature",title:V.TEMPERATURE.title,description:V.TEMPERATURE.description,min:0,max:1,step:.01,default:1}),De=n=>ee({param:"max_tokens",title:V.MAX_TOKENS.title,description:V.MAX_TOKENS.description,min:0,max:n,step:1,default:0}),Fe=n=>po({param:"stop_sequences",title:V.STOP(n).title,description:V.STOP(n).description,max:n}),He=ee({param:"top_p",title:V.TOP_P.title,description:V.TOP_P.description,min:0,max:1,step:.01,default:1}),Ke=ee({param:"top_k",title:V.TOP_K.title,description:V.TOP_K.description,min:0,max:1,step:.01,default:1}),Ge=te({param:"tool_choice",title:"Tool choice",description:"Controls which (if any) tool is called by the model.     'any' means the model will call any of the provided tools.     'auto' means the model can pick between generating a message or calling a tool.",default:"auto",choices:["auto","any"]});var fo=(n,e)=>zod.z.object({temperature:$e.schema,maxTokens:De(n).schema,stop:Fe(e).schema,topP:He.schema,topK:Ke.schema,toolChoice:Ge.schema}),bo=(n,e)=>({temperature:$e.def,maxTokens:De(n).def,stop:Fe(e).def,topP:He.def,topK:Ke.def,toolChoice:Ge.def});var Je=te({param:"encoding_format",title:"Encoding format",description:"Select the encoding format for the word embedding.",default:null,choices:["base64"]}),We=te({param:"input_type",title:"Input type",description:"Select the input type for the word embedding.",default:null,choices:["query","document"]}),Ze=ho({param:"truncation",title:"Truncation",description:"Select the truncation for the word embedding.",default:!0});var Co=()=>zod.z.object({encodingFormat:Je.schema,inputType:We.schema,truncation:Ze.schema}),To=()=>({encodingFormat:Je.def,inputType:We.def,truncation:Ze.def});var u={base:(n,e)=>({def:bo(n,e),schema:fo(n,e)})},f={base:()=>({def:To(),schema:Co()})};var ra="anthropic",J=class{constructor(){this.version="v1";this.name=ra;this.chatModelFactories={[nt]:{model:pe,modelOptions:Ro,modelSchema:at},[mt]:{model:he,modelOptions:Ao,modelSchema:ct},[dt]:{model:ue,modelOptions:xo,modelSchema:pt},[Ye]:{model:re,modelOptions:Mo,modelSchema:Qe},[Xe]:{model:le,modelOptions:Eo,modelSchema:et},[st]:{model:me,modelOptions:vo,modelSchema:it},[tt]:{model:de,modelOptions:So,modelSchema:ot},[rt]:{model:ce,modelOptions:Oo,modelSchema:lt}};this.embeddingModelFactories={[St]:{model:Te,modelOptions:Lo,modelSchema:Rt},[Mt]:{model:Ce,modelOptions:Io,modelSchema:Et},[ut]:{model:ge,modelOptions:ko,modelSchema:ht},[gt]:{model:ye,modelOptions:_o,modelSchema:yt},[ft]:{model:fe,modelOptions:wo,modelSchema:bt},[Ct]:{model:be,modelOptions:qo,modelSchema:Tt}};}chatModelLiterals(){return Object.keys(this.chatModelFactories)}chatModelSchemas(){return Object.keys(this.chatModelFactories).reduce((e,o)=>(e[o]=this.chatModelFactories[o].modelSchema,e),{})}chatModel(e){let o=e.modelName;if(!(o in this.chatModelFactories))throw new je({info:`Anthropic chat model: ${o} not found`,cause:new Error(`Anthropic chat model: ${o} not found, available chat models: 
          ${this.chatModelLiterals().join(", ")}`)});let a=this.chatModelFactories[o].model,l=this.chatModelFactories[o].modelOptions.parse(e);return new a(l)}embeddingModelLiterals(){return Object.keys(this.embeddingModelFactories)}embeddingModelSchemas(){return Object.keys(this.embeddingModelFactories).reduce((e,o)=>(e[o]=this.embeddingModelFactories[o].modelSchema,e),{})}embeddingModel(e){let o=e.modelName;if(!(o in this.embeddingModelFactories))throw new je({info:`Anthropic embedding model: ${o} not found`,cause:new Error(`Anthropic embedding model: ${o} not found, available embedding models: 
          ${this.embeddingModelLiterals().join(", ")}`)});let a=this.embeddingModelFactories[o].model,l=this.embeddingModelFactories[o].modelOptions.parse(e);return new a(l)}};J.chatBaseUrl="https://api.anthropic.com/v1",J.embeddingBaseUrl="https://api.voyageai.com/v1";var M=zod.z.enum([Z,z,k,Q]),E={system:Z,user:z,assistant:k,tool:z};var S=[O,H,N,K],R=zod.z.enum([O,H,N,K]);var pa=zod.z.object({type:zod.z.literal("text"),text:zod.z.string()}),ma=zod.z.object({type:zod.z.literal("tool_use"),id:zod.z.string(),name:zod.z.string(),input:zod.z.record(zod.z.any())}),jo=zod.z.object({content:zod.z.array(zod.z.discriminatedUnion("type",[pa,ma])),id:zod.z.string(),model:zod.z.string(),role:zod.z.string(),stop_reason:zod.z.string(),stop_sequence:zod.z.null(),type:zod.z.literal("message"),usage:zod.z.object({input_tokens:zod.z.number(),output_tokens:zod.z.number(),cache_creation_input_tokens:zod.z.number().nullish(),cache_read_input_tokens:zod.z.number().nullish()})}),Po=zod.z.object({type:zod.z.literal("message_start"),message:zod.z.object({id:zod.z.string(),type:zod.z.literal("message"),role:zod.z.string(),model:zod.z.string(),stop_reason:zod.z.string().nullable(),stop_sequence:zod.z.string().nullable(),content:zod.z.array(zod.z.any()),usage:zod.z.object({input_tokens:zod.z.number(),output_tokens:zod.z.number()})})}),Bo=zod.z.object({type:zod.z.literal("message_delta"),delta:zod.z.object({stop_reason:zod.z.string().nullable(),stop_sequence:zod.z.string().nullable()}),usage:zod.z.object({output_tokens:zod.z.number()})}),ca=zod.z.object({type:zod.z.literal("text"),text:zod.z.string()}),ua=zod.z.object({type:zod.z.literal("tool_use"),id:zod.z.string(),name:zod.z.string(),input:zod.z.object({})}),No=zod.z.object({type:zod.z.literal("content_block_start"),index:zod.z.number(),content_block:zod.z.discriminatedUnion("type",[ca,ua])}),ha=zod.z.object({type:zod.z.literal("text_delta"),text:zod.z.string()}),ga=zod.z.object({type:zod.z.literal("input_json_delta"),partial_json:zod.z.string()}),Vo=zod.z.object({type:zod.z.literal("content_block_delta"),index:zod.z.number(),delta:zod.z.discriminatedUnion("type",[ha,ga])});var ya=zod.z.object({name:zod.z.string().min(1),description:zod.z.string().min(1).optional(),input_schema:zod.z.any()}),fa=zod.z.object({type:zod.z.enum(["auto","any"])}),ba=zod.z.object({type:zod.z.literal("tool"),name:zod.z.string().min(1)}),vt=zod.z.object({text:zod.z.string().min(1),type:zod.z.literal("text")}),Uo=zod.z.object({type:zod.z.literal("image"),source:zod.z.object({type:zod.z.literal("base64"),media_type:zod.z.enum(["image/jpeg","image/png","image/gif","image/webp"]),data:zod.z.string().base64()})}),ws=zod.z.object({id:zod.z.string().min(1),type:zod.z.literal("tool_use"),name:zod.z.string().min(1),input:zod.z.record(zod.z.any())}),zo=zod.z.object({type:zod.z.literal("tool_result"),tool_use_id:zod.z.string().min(1),content:zod.z.string().min(1).or(zod.z.array(zod.z.union([vt,Uo])).min(1))}),Ca=zod.z.object({role:zod.z.literal("user"),content:zod.z.string().min(1).or(zod.z.array(zod.z.union([vt,Uo,zo])).min(1))}),Ta=zod.z.object({role:zod.z.literal("assistant"),content:zod.z.string().min(1).or(zod.z.array(zod.z.union([vt,zo])).min(1))}),Ma=zod.z.union([Ca,Ta]),$o=zod.z.object({model:zod.z.string().min(1).optional(),messages:zod.z.array(Ma).min(1),system:zod.z.string().min(1).optional(),max_tokens:zod.z.number().min(0).optional(),stop_sequences:zod.z.array(zod.z.string().min(1)).optional(),temperature:zod.z.number().min(0).max(1).optional(),tool_choice:zod.z.union([fa,ba]).optional(),tools:zod.z.array(ya).min(1).optional(),top_p:zod.z.number().min(0).max(1).optional(),top_k:zod.z.number().min(0).optional()});var C=zod.z.object({modelName:zod.z.string(),apiKey:zod.z.string(),completeChatUrl:zod.z.string().url().optional(),streamChatUrl:zod.z.string().url().optional()}),b=class{constructor(e,o){this.version="v1";let a=C.parse(o);this.modelSchema=e,this.modelName=a.modelName,this.apiKey=a.apiKey,this.baseUrl=Y(J.chatBaseUrl),this.completeChatUrl=Y(a.completeChatUrl||`${this.baseUrl}/messages`),this.streamChatUrl=Y(a.streamChatUrl||`${this.baseUrl}/messages`);}getDefaultBaseUrl(){return this.baseUrl}getDefaultHeaders(){return {"x-api-key":`${this.apiKey}`,"anthropic-version":"2023-06-01","content-type":"application/json"}}getDefaultParams(){return {model:this.modelName}}getRetryDelay(e){let o=0,a=!0;return e["x-should-retry"]&&(a=e["x-should-retry"].toLowerCase()!=="false"),e["retry-after"]&&(o=parseInt(e["retry-after"])*1e3),{shouldRetry:a,delayMs:o}}getTokenCount(e){return e.reduce((o,a)=>o+a.content.map(l=>l.modality==="text"?l.value:"").join(" ").length,0)}transformModelRequest(e){let o=$o.safeParse(e);if(!o.success)throw new X({info:"Invalid model request",cause:o.error});let a=o.data,l=a.model;if(a.tool_choice&&(!a.tools||a.tools.length===0))throw new X({info:`Invalid model request for model : '${this.modelName}'`,cause:new Error("'tools' are required when 'tool_choice' is specified")});let p={};a.tool_choice&&(a.tool_choice.type==="tool"?p.toolChoice=a.tool_choice.name:p.toolChoice=a.tool_choice.type),p.maxTokens=a.max_tokens,p.temperature=a.temperature,p.topP=a.top_p,p.topK=a.top_k,p.stop=a.stop_sequences;let s=ae().parse(ie(p)),i=[],d={};a.system&&i.push({role:Z,content:[{modality:O,value:a.system}]}),a.messages.forEach(g=>{let w=g.role;switch(w){case"user":{let q=g.content;if(typeof q=="string")i.push({role:w,content:[{modality:O,value:q}]});else {let I=q.map(y=>{if(y.type==="text")return {modality:O,value:y.text};if(y.type==="image"){let Ee="auto",ne=y.source.media_type.split("/")[1];return {modality:H,detail:Ee,value:{type:Oe,media_type:ne,base64:y.source.data}}}else return {modality:K,id:y.tool_use_id,index:d[y.tool_use_id].index,name:d[y.tool_use_id].name,data:typeof y.content=="string"?y.content:JSON.stringify(y.content)}});i.push({role:w,content:I});}}break;case"assistant":{let q=g.content;if(typeof q=="string")i.push({role:w,content:[{modality:O,value:q}]});else {let I=q.map((y,Ee)=>{if(y.type==="text")return {modality:O,value:y.text};{let ne={modality:N,id:y.id,index:Ee,name:y.name,arguments:JSON.stringify(y.input)};return d[y.id]=ne,ne}});i.push({role:w,content:I});}}break}});let h=[];return a.tools&&a.tools.forEach(g=>{h.push({type:"function",definition:{schema:{name:g.name,description:g.description||"",parameters:g.input_schema}}});}),{modelName:l,config:s,messages:i,tools:h.length>0?h:void 0}}transformConfig(e,o,a){let l=e.toolChoice;delete e.toolChoice;let p=this.modelSchema.config.schema.safeParse(e);if(!p.success)throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:p.error});let s=p.data;l!==void 0&&(s.toolChoice=l),Object.keys(s).forEach(d=>{if(!(d in this.modelSchema.config.def))throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`Invalid config key : '${d}', 
            available keys : [${Object.keys(this.modelSchema.config.def).join(", ")}]`)})});let i=Object.keys(s).reduce((d,h)=>{let g=this.modelSchema.config.def[h],w=g.param,q=s[h];return w==="max_tokens"&&g.type==="range"&&q===0?d[w]=g.max:d[w]=q,d},{});if(!i.max_tokens)throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`'max_tokens' is required for model : '${this.modelName}'`)});if("tool_choice"in i&&i.tool_choice!==void 0){let d=i.tool_choice;if(!a||a&&a.length===0)throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:new Error("'tools' are required when 'toolChoice' is specified")});if(a&&a.length>0){let h=this.modelSchema.config.def.toolChoice;if(h.choices.includes(d))i.tool_choice={type:d};else if(a.map(g=>g.definition.schema.name).includes(d))i.tool_choice={type:"tool",name:d};else throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`toolChoice : '${d}' is not part of provided 'tools' names or 
              one of [${h.choices.join(", ")}]`)})}}return i}transformMessages(e){if(!e||e&&e.length===0)return {messages:[]};let o=e.map(s=>{let i=ke().safeParse(s);if(!i.success)throw new x({info:"Invalid messages",cause:i.error});return i.data});o.forEach(s=>{s.content.forEach(i=>{if(!this.modelSchema.modalities.includes(i.modality))throw new x({info:`Invalid message content for model : '${this.modelName}'`,cause:new Error(`model : '${this.modelName}' does not support modality : '${i.modality}', 
              available modalities : [${this.modelSchema.modalities.join(", ")}]`)})});}),o.forEach(s=>{if(!Object.keys(this.modelSchema.roles).includes(s.role))throw new x({info:`Invalid message content for model : '${this.modelName}'`,cause:new Error(`model : '${this.modelName}' does not support role : '${s.role}', 
            available roles : [${Object.keys(this.modelSchema.roles).join(", ")}]`)})});let a="",l=[];if(o.forEach(s=>{switch(s.role){case Z:s.content.forEach(i=>{if(i.modality===O)a+=i.value;else throw new x({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${s.role}' cannot have content with modality : '${i.modality}'`)})});break;case k:{let i=[];s.content.forEach(d=>{if(d.modality===O)i.push({type:"text",text:d.value});else if(d.modality===N)i.push({type:"tool_use",id:d.id,name:d.name,input:JSON.parse(d.arguments)});else throw new x({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${s.role}' cannot have content with modality : '${d.modality}'`)})}),l.push({role:this.modelSchema.roles[s.role],content:i});}break;case z:{let i=[];s.content.forEach(d=>{if(d.modality===O)i.push({type:"text",text:d.value});else if(d.modality===H){if(d.value.type==="base64")i.push({type:"image",source:{type:"base64",media_type:`image/${d.value.media_type}`,data:d.value.base64}});else if(d.value.type==="url")throw new x({info:`Invalid message 'modality' for model : ${this.modelName}`,cause:new Error(`model: '${this.modelName}' does not support image content type: '${d.value.type}'`)})}else throw new x({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${s.role}' cannot have content with modality : '${d.modality}'`)})}),l.push({role:this.modelSchema.roles[s.role],content:i});}break;case Q:{let i=[];s.content.forEach(d=>{if(d.modality===K)i.push({type:"tool_result",tool_use_id:d.id,content:d.data});else throw new x({info:`Invalid message 'role' and 'modality' combination for model : ${this.modelName}`,cause:new Error(`role : '${s.role}' cannot have content with modality : '${d.modality}'`)})}),l.push({role:this.modelSchema.roles[s.role],content:i});}break;default:throw new x({info:`Invalid message 'role' for model : ${this.modelName}`,cause:new Error(`role : '${s.role}' is not supported, 
              available roles : [${Object.keys(this.modelSchema.roles).join(", ")}]`)})}}),l[0].role!==this.modelSchema.roles[z])throw new x({info:`Invalid message 'role' for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' requires first message to be from user`)});let p=s=>s===this.modelSchema.roles[z]?this.modelSchema.roles[k]:this.modelSchema.roles[z];for(let s=1;s<l.length;s++)if(l[s].role!==p(l[s-1].role))throw new x({info:`Invalid message format for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' requires messages to alternate between user and assistant`)});return {system:a,messages:l}}transformTools(e){if(!this.modelSchema.modalities.includes(N))throw new Pe({info:`Invalid tool 'modality' for model : ${this.modelName}`,cause:new Error(`model : '${this.modelName}' does not support tool modality : '${N}'`)});return !e||e&&e.length===0?{tools:[]}:{tools:e.map(l=>{let p=Ut().safeParse(l);if(!p.success)throw new Pe({info:"Invalid tools",cause:p.error});return p.data}).map(l=>({name:l.definition.schema.name,description:l.definition.schema.description,input_schema:l.definition.schema.parameters}))}}getCompleteChatUrl(e,o,a){return U(this,null,function*(){return new Promise(l=>{l(this.completeChatUrl);})})}getCompleteChatHeaders(e,o,a){return U(this,null,function*(){let l=this.getDefaultHeaders();return a&&a.length>0&&(l=Se(v({},l),{"anthropic-beta":"tools-2024-05-16"})),new Promise(p=>{p(l);})})}getCompleteChatData(e,o,a){return U(this,null,function*(){let l=this.transformConfig(e,o,a),p=this.transformMessages(o);if(p.messages&&p.messages.length===0)throw new x({info:"Messages are required",cause:new Error("Messages are required")});let s=a?this.transformTools(a):{};return new Promise(i=>{i(v(v(v(v({},this.getDefaultParams()),l),p),s));})})}transformCompleteChatResponse(e){let o=jo.safeParse(e);if(o.success){let a=o.data,p=a.content.map((d,h)=>{if(d.type==="text")return Nt(d.text);if(d.type==="tool_use")return Vt(h,d.id,d.name,JSON.stringify(d.input))}),s=[{role:k,content:p}],i={promptTokens:a.usage.input_tokens,completionTokens:a.usage.output_tokens,totalTokens:a.usage.input_tokens+a.usage.output_tokens};return {messages:s,usage:i,logProbs:[]}}throw new $({info:"Invalid response from model",cause:o.error})}getStreamChatUrl(e,o,a){return U(this,null,function*(){return new Promise(l=>{l(this.streamChatUrl);})})}getStreamChatHeaders(e,o,a){let l=this.getDefaultHeaders();return a&&a.length>0&&(l=Se(v({},l),{"anthropic-beta":"tools-2024-05-16"})),new Promise(p=>{p(l);})}getStreamChatData(e,o,a){return U(this,null,function*(){let l=this.transformConfig(e,o,a),p=this.transformMessages(o);if(p.messages&&p.messages.length===0)throw new x({info:"Messages are required",cause:new Error("Messages are required")});let s=a?this.transformTools(a):{};return new Promise(i=>{i(v(v(v(v({stream:!0},this.getDefaultParams()),l),p),s));})})}transformStreamChatResponseChunk(e,o){return At(this,null,function*(){let a=(o+e).split(`
`).filter(l=>l.trim()!=="");for(let l of a)if(l.startsWith("data: {")&&l.endsWith("}")){let p;try{p=JSON.parse(l.substring(6));}catch(s){throw new $({info:`Malformed JSON received in stream : ${p}`,cause:s})}if("type"in p){if(p.type==="message_stop")return;if(p.type==="message_start"){let s=Po.safeParse(p);if(s.success){let i=s.data;yield {partialResponse:{partialMessages:[],usage:{promptTokens:i.message.usage.input_tokens,completionTokens:i.message.usage.output_tokens,totalTokens:i.message.usage.input_tokens+i.message.usage.output_tokens}},buffer:o};}else throw new $({info:"Invalid response from model",cause:s.error})}else if(p.type==="message_delta"){let s=Bo.safeParse(p);if(s.success){let i=s.data;yield {partialResponse:{partialMessages:[],usage:{promptTokens:0,completionTokens:i.usage.output_tokens,totalTokens:i.usage.output_tokens}},buffer:o};}else throw new $({info:"Invalid response from model",cause:s.error})}else if(p.type==="content_block_start"){let s=No.safeParse(p);if(s.success){let i=s.data,d=[];i.content_block.type==="text"?d.push(we(k,i.content_block.text)):i.content_block.type==="tool_use"&&d.push(qe(k,i.index,i.content_block.id,i.content_block.name,"")),yield {partialResponse:{partialMessages:d},buffer:o};}else throw new $({info:"Invalid response from model",cause:s.error})}else if(p.type==="content_block_delta"){let s=Vo.safeParse(p);if(s.success){let i=s.data,d=[];i.delta.type==="text_delta"?d.push(we(k,i.delta.text)):i.delta.type==="input_json_delta"&&d.push(qe(k,i.index,"","",i.delta.partial_json)),yield {partialResponse:{partialMessages:d},buffer:o};}else throw new $({info:"Invalid response from model",cause:s.error})}}else throw new $({info:"Invalid JSON received in stream",cause:new Error(`Invalid JSON received in stream, expected 'type' property, 
              received : ${JSON.stringify(p)}`)})}})}};var Ye="claude-3-5-sonnet-20240620",Ea="Most intelligent model. Highest level of intelligence and capability.",Qe=T(M,R).parse({name:Ye,description:Ea,maxInputTokens:2e5,maxOutputTokens:8192,roles:E,modalities:S,config:{def:u.base(8192,4).def,schema:u.base(8192,4).schema}}),Mo=C,re=class extends b{constructor(e){super(Qe,e);}};var Xe="claude-3-5-sonnet-20241022",Sa="Most intelligent model. Highest level of intelligence and capability.",et=T(M,R).parse({name:Xe,description:Sa,maxInputTokens:2e5,maxOutputTokens:8192,roles:E,modalities:S,config:{def:u.base(8192,4).def,schema:u.base(8192,4).schema}}),Eo=C,le=class extends b{constructor(e){super(et,e);}};var tt="claude-3-5-sonnet-latest",Ra="Most intelligent model. Highest level of intelligence and capability.",ot=T(M,R).parse({name:tt,description:Ra,maxInputTokens:2e5,maxOutputTokens:8192,roles:E,modalities:S,config:{def:u.base(8192,4).def,schema:u.base(8192,4).schema}}),So=C,de=class extends b{constructor(e){super(ot,e);}};var nt="claude-3-haiku-20240307",va="Fastest and most compact model for near-instant responsiveness. Quick and accurate targeted performance.",at=T(M,R).parse({name:nt,description:va,maxInputTokens:2e5,maxOutputTokens:4096,roles:E,modalities:S,config:{def:u.base(4096,4).def,schema:u.base(4096,4).schema}}),Ro=C,pe=class extends b{constructor(e){super(at,e);}};var st="claude-3-5-haiku-20241022",Oa="Our fastest model with intelligence at blazing speeds.",it=T(M,R).parse({name:st,description:Oa,maxInputTokens:2e5,maxOutputTokens:8192,roles:E,modalities:S,config:{def:u.base(8192,4).def,schema:u.base(8192,4).schema}}),vo=C,me=class extends b{constructor(e){super(it,e);}};var rt="claude-3-5-haiku-latest",xa="Our fastest model with intelligence at blazing speeds.",lt=T(M,R).parse({name:rt,description:xa,maxInputTokens:2e5,maxOutputTokens:8192,roles:E,modalities:S,config:{def:u.base(8192,4).def,schema:u.base(8192,4).schema}}),Oo=C,ce=class extends b{constructor(e){super(lt,e);}};var dt="claude-3-opus-20240229",Aa="Powerful model for highly complex tasks. Top-level performance, intelligence, fluency, and understanding.",pt=T(M,R).parse({name:dt,description:Aa,maxInputTokens:2e5,maxOutputTokens:4096,roles:E,modalities:S,config:{def:u.base(4096,4).def,schema:u.base(4096,4).schema}}),xo=C,ue=class extends b{constructor(e){super(pt,e);}};var mt="claude-3-sonnet-20240229",ka="Balance of intelligence and speed. Strong utility, balanced for scaled deployments.",ct=T(M,R).parse({name:mt,description:ka,maxInputTokens:2e5,maxOutputTokens:4096,roles:E,modalities:S,config:{def:u.base(4096,4).def,schema:u.base(4096,4).schema}}),Ao=C,he=class extends b{constructor(e){super(ct,e);}};var j=[G],P=zod.z.enum([G]);var Do=zod.z.object({object:zod.z.literal("list"),model:zod.z.string(),data:zod.z.array(zod.z.object({index:zod.z.number(),object:zod.z.literal("embedding"),embedding:zod.z.array(zod.z.number()).or(zod.z.string().base64())})),usage:zod.z.object({total_tokens:zod.z.number()})});var wa=zod.z.string().min(1).or(zod.z.array(zod.z.string().min(1)).min(1)),Fo=zod.z.object({model:zod.z.string().min(1).optional(),input:wa,encoding_format:zod.z.enum(["base64"]).nullable().optional(),input_type:zod.z.enum(["query","document"]).nullable().optional(),truncation:zod.z.boolean().optional()});var _=zod.z.object({modelName:zod.z.string(),apiKey:zod.z.string(),getEmbeddingsUrl:zod.z.string().url().optional()}),A=class{constructor(e,o){this.version="v1";let a=_.parse(o);this.modelSchema=e,this.modelName=a.modelName,this.apiKey=a.apiKey,this.baseUrl=Y(J.embeddingBaseUrl),this.getEmbeddingsUrl=Y(a.getEmbeddingsUrl||`${this.baseUrl}/embeddings`);}getDefaultBaseUrl(){return this.baseUrl}getDefaultHeaders(){return {Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}getDefaultParams(){return {model:this.modelName}}getTokenCount(e){return e.requests.reduce((o,a)=>o+a.length,0)}getRetryDelay(e){return {shouldRetry:!0,delayMs:0}}transformModelRequest(e){let o=Fo.safeParse(e);if(!o.success)throw new X({info:"Invalid model request",cause:o.error});let a=o.data,l=a.model,p={encodingFormat:a.encoding_format,inputType:a.input_type,truncation:a.truncation},s=ae().parse(ie(p)),i;return typeof a.input=="string"?i={modality:G,requests:[a.input]}:i={modality:G,requests:a.input},{modelName:l,config:s,embeddingRequests:i}}transformConfig(e,o){let a=this.modelSchema.config.schema.safeParse(e);if(!a.success)throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:a.error});let l=a.data;return Object.keys(l).forEach(s=>{if(!this.modelSchema.config.def[s])throw new D({info:`Invalid config for model : '${this.modelName}'`,cause:new Error(`Invalid config key : '${s}', 
            available keys : [${Object.keys(this.modelSchema.config.def).join(", ")}]`)})}),Object.keys(l).reduce((s,i)=>{let h=this.modelSchema.config.def[i].param,g=l[i];return s[h]=g,s},{})}transformEmbeddingRequests(e){let o=Dt().safeParse(e);if(!o.success)throw new Be({info:"Invalid embedding requests",cause:o.error});if(o.data.requests.length>128)throw new Be({info:`Invalid embedding requests for model : '${this.modelName}'`,cause:new Error(`Max requests for model : '${this.modelName}' is 128`)});return {input:o.data.requests}}getGetEmbeddingsUrl(e,o){return U(this,null,function*(){return new Promise(a=>{a(this.getEmbeddingsUrl);})})}getGetEmbeddingsHeaders(e,o){return U(this,null,function*(){return new Promise(a=>{a(this.getDefaultHeaders());})})}getGetEmbeddingsData(e,o){return U(this,null,function*(){return new Promise(a=>{a(v(v(v({},this.getDefaultParams()),this.transformConfig(e,o)),this.transformEmbeddingRequests(o)));})})}transformGetEmbeddingsResponse(e){let o,a=Do.safeParse(e);if(a.success){let l=a.data;o=typeof l.data[0].embedding=="string"?Le:Ie;let p=l.data.map(s=>typeof s.embedding=="string"?{index:s.index,embedding:s.embedding}:{index:s.index,embedding:s.embedding});return {encodingFormat:o,embeddings:p,usage:{totalTokens:l.usage.total_tokens}}}throw new $({info:"Invalid response from model",cause:a.error})}};var ut="voyage-code-2",qa="Optimized for code retrieval.",ht=L(P).parse({name:ut,description:qa,modalities:j,maxInputTokens:16e3,maxOutputTokens:16e3,config:{def:f.base().def,schema:f.base().schema}}),ko=_,ge=class extends A{constructor(e){super(ht,e);}};var gt="voyage-law-2",Ia="Optimized for legal and long-context retrieval and RAG. Also improved performance across all domains.",yt=L(P).parse({name:gt,description:Ia,modalities:j,maxInputTokens:16e3,maxOutputTokens:16e3,config:{def:f.base().def,schema:f.base().schema}}),_o=_,ye=class extends A{constructor(e){super(yt,e);}};var ft="voyage-multilingual-2",La="Optimized for multilingual retrieval and RAG.",bt=L(P).parse({name:ft,description:La,modalities:j,maxInputTokens:32e3,maxOutputTokens:32e3,config:{def:f.base().def,schema:f.base().schema}}),wo=_,fe=class extends A{constructor(e){super(bt,e);}};var Ct="voyage-finance-2",ja="Optimized for finance retrieval and RAG.",Tt=L(P).parse({name:Ct,description:ja,modalities:j,maxInputTokens:32e3,maxOutputTokens:32e3,config:{def:f.base().def,schema:f.base().schema}}),qo=_,be=class extends A{constructor(e){super(Tt,e);}};var Mt="voyage-3-lite",Pa="Optimized for latency and cost.",Et=L(P).parse({name:Mt,description:Pa,modalities:j,maxInputTokens:32e3,maxOutputTokens:32e3,config:{def:f.base().def,schema:f.base().schema}}),Io=_,Ce=class extends A{constructor(e){super(Et,e);}};var St="voyage-3",Ba="Optimized for quality.",Rt=L(P).parse({name:St,description:Ba,modalities:j,maxInputTokens:32e3,maxOutputTokens:32e3,config:{def:f.base().def,schema:f.base().schema}}),Lo=_,Te=class extends A{constructor(e){super(Rt,e);}};

exports.Anthropic = J;
exports.AnthropicChatModelConfigs = u;
exports.AnthropicChatModelModalities = S;
exports.AnthropicChatModelModalitiesEnum = R;
exports.AnthropicChatModelRoles = M;
exports.AnthropicChatModelRolesMap = E;
exports.AnthropicCompleteChatResponse = jo;
exports.AnthropicEmbeddingModelConfigs = f;
exports.AnthropicEmbeddingModelModalities = j;
exports.AnthropicEmbeddingModelModalitiesEnum = P;
exports.AnthropicEmbeddingRequest = Fo;
exports.AnthropicEmbeddingRequestInput = wa;
exports.AnthropicGetEmbeddingsResponse = Do;
exports.AnthropicRequest = $o;
exports.AnthropicRequestAssistantMessage = Ta;
exports.AnthropicRequestImageContent = Uo;
exports.AnthropicRequestMessage = Ma;
exports.AnthropicRequestTextContent = vt;
exports.AnthropicRequestTool = ya;
exports.AnthropicRequestToolCallContent = ws;
exports.AnthropicRequestToolChoiceEnum = fa;
exports.AnthropicRequestToolChoiceTool = ba;
exports.AnthropicRequestToolResponseContent = zo;
exports.AnthropicRequestUserMessage = Ca;
exports.AnthropicStreamChatContentBlockDeltaResponse = Vo;
exports.AnthropicStreamChatContentBlockStartResponse = No;
exports.AnthropicStreamChatMessageDeltaResponse = Bo;
exports.AnthropicStreamChatMessageStartResponse = Po;
exports.BaseChatModel = b;
exports.BaseChatModelOptions = C;
exports.BaseEmbeddingModel = A;
exports.BaseEmbeddingModelOptions = _;
exports.ChatModelBaseConfigDef = bo;
exports.ChatModelBaseConfigSchema = fo;
exports.Claude3Haiku20240307 = pe;
exports.Claude3Haiku20240307Literal = nt;
exports.Claude3Haiku20240307Options = Ro;
exports.Claude3Haiku20240307Schema = at;
exports.Claude3Opus20240229 = ue;
exports.Claude3Opus20240229Literal = dt;
exports.Claude3Opus20240229Options = xo;
exports.Claude3Opus20240229Schema = pt;
exports.Claude3Sonnet20240229 = he;
exports.Claude3Sonnet20240229Literal = mt;
exports.Claude3Sonnet20240229Options = Ao;
exports.Claude3Sonnet20240229Schema = ct;
exports.Claude3_5Haiku20241022 = me;
exports.Claude3_5Haiku20241022Literal = st;
exports.Claude3_5Haiku20241022Options = vo;
exports.Claude3_5Haiku20241022Schema = it;
exports.Claude3_5HaikuLatest = ce;
exports.Claude3_5HaikuLatestLiteral = rt;
exports.Claude3_5HaikuLatestOptions = Oo;
exports.Claude3_5HaikuLatestSchema = lt;
exports.Claude3_5Sonnet20240620 = re;
exports.Claude3_5Sonnet20240620Literal = Ye;
exports.Claude3_5Sonnet20240620Options = Mo;
exports.Claude3_5Sonnet20240620Schema = Qe;
exports.Claude3_5Sonnet20241022 = le;
exports.Claude3_5Sonnet20241022Literal = Xe;
exports.Claude3_5Sonnet20241022Options = Eo;
exports.Claude3_5Sonnet20241022Schema = et;
exports.Claude3_5SonnetLatest = de;
exports.Claude3_5SonnetLatestLiteral = tt;
exports.Claude3_5SonnetLatestOptions = So;
exports.Claude3_5SonnetLatestSchema = ot;
exports.EmbeddingModelBaseConfigDef = To;
exports.EmbeddingModelBaseConfigSchema = Co;
exports.ProviderLiteral = ra;
exports.Voyage3 = Te;
exports.Voyage3Lite = Ce;
exports.Voyage3LiteLiteral = Mt;
exports.Voyage3LiteOptions = Io;
exports.Voyage3LiteSchema = Et;
exports.Voyage3Literal = St;
exports.Voyage3Options = Lo;
exports.Voyage3Schema = Rt;
exports.VoyageCode2 = ge;
exports.VoyageCode2Literal = ut;
exports.VoyageCode2Options = ko;
exports.VoyageCode2Schema = ht;
exports.VoyageFinance2 = be;
exports.VoyageFinance2Literal = Ct;
exports.VoyageFinance2Options = qo;
exports.VoyageFinance2Schema = Tt;
exports.VoyageLaw2 = ye;
exports.VoyageLaw2Literal = gt;
exports.VoyageLaw2Options = _o;
exports.VoyageLaw2Schema = yt;
exports.VoyageMultilingual2 = fe;
exports.VoyageMultilingual2Literal = ft;
exports.VoyageMultilingual2Options = wo;
exports.VoyageMultilingual2Schema = bt;
exports.encodingFormat = Je;
exports.inputType = We;
exports.maxTokens = De;
exports.stop = Fe;
exports.temperature = $e;
exports.toolChoice = Ge;
exports.topK = Ke;
exports.topP = He;
exports.truncation = Ze;
//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map